!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=7)}([function(t,e){t.exports=require("base58check")},function(t,e){t.exports={username:"asch",password:"asch123456",network:"testnet",port:28332,host:"39.107.158.80"}},function(t,e){t.exports=require("safe-buffer")},function(t,e){t.exports=require("coinselect")},function(t,e){t.exports=require("bitcoin-core")},function(t,e){t.exports=require("bitcoinjs-lib")},function(t,e,r){const n=r(5),o=r(4),s=r(3),i=r(2).Buffer,a=r(1),c=r(0),u=n.networks.bitcoin,l=n.networks.testnet,p=new o({username:a.username,password:a.password,network:a.network,port:a.port,host:a.host});if("testnet"===a.network)var d={network:l};else if("mainnet"===a.network)d={network:u};const f=async(t,e)=>{const r=await p.getRawTransaction(t);return(await p.decodeRawTransaction(r)).vout[e].scriptPubKey.addresses[0]};var h;t.exports={generateAccount:()=>{const t=new n.ECPair.makeRandom(d);return{privateKey:t.toWIF(),publicKey:t.Q.getEncoded().toString("hex"),address:t.getAddress()}},importPrivKeyToWallet:(t,e)=>{p.importPrivKey(t.privateKey,"",!1,e)},createMultisigAddress:(t,e)=>{const r={},o=e.map(t=>i.from(t,"hex")),s=n.script.multisig.output.encode(2,o,d.network),a=n.script.scriptHash.output.encode(n.crypto.hash160(s),d.network),c=n.address.fromOutputScript(a,d.network);return r.address=c,r.accountExtrsInfo={redeemScript:s},r},createNewTransaction:(t,e,r)=>{let o={};r=((i,a)=>{if(i)return r(i);let{inputs:c,outputs:u,fee:l}=s(a,e,100);if(!c||!u)return r("No inputs or outputs");let p=new n.TransactionBuilder(d.network);try{c.forEach(t=>p.addInput(t.txid,t.vout)),u.forEach(e=>{e.address||(e.address=t.address),p.addOutput(e.address,e.value)})}catch(t){return r(t.message)}o.txhex=p.buildIncomplete().toHex();let h=[];for(let t=0;t<c.length;t++)h.push(f(c[t].txid,c[t].vout));Promise.all(h).then(t=>{o.txhex=p.buildIncomplete().toHex(),o.input=t,r(null,o)})}),p.listUnspent(0,(t,e)=>{if(t)return r(t);const n=e.sort((t,e)=>t.amount-e.amount).map(t=>({txid:t.txid,vout:t.vout,value:Math.round(1e8*t.amount)}));r(null,n)})},signTransaction:(t,e,r)=>{const o=e.privateKey,s=n.TransactionBuilder.fromTransaction(n.Transaction.fromHex(t.txhex),d.network),a=n.ECPair.fromWIF(o,d.network);for(let e=0;e<t.input.length;e++){const n=i.from(r[t.input[e]],"hex");s.sign(e,a,n)}const c=s.inputs.map(t=>t.signatures),u=[];for(let t=0;t<c.length;t++){let e={},r=c[t].filter(t=>Boolean(t))[0];e[String(c[t].indexOf(r))]=r.toString("hex"),u.push(e)}return u},buildTransaction:(t,e,r)=>{let o=(t=>{let e=[];for(let r=0;r<t.length;r++)for(let n=0;n<t[0].length;n++){e[n]=e[n]||[];let o=Object.keys(t[r][n]);e[n][Number(o)]=t[r][n][o]}return e})(e),s=[];for(let a=0;a<e[0].length;a++){let e=t.input[a];s.push({redeemScript:i.from(r[e],"hex"),redeemScriptType:"multisig",pubKeys:n.script.multisig.output.decode(i.from(r[e],"hex")).pubKeys,signatures:o[a].map(t=>i.from(t,"hex")),signScript:i.from(r[t.input[a]],"hex"),signType:"multisig",prevOutScript:n.crypto.hash160(i.from(r[e],"hex")),prevOutType:"scripthash",witness:!1})}const a=n.TransactionBuilder.fromTransaction(n.Transaction.fromHex(t.txhex),d.network);return a.inputs=s,a.build().toHex()},sendRawTransaction:(t,e)=>{p.sendRawTransaction(t,e)},getTransactionHistory:(t,e)=>{p.listTransactions((r,n)=>{if(r)return e(r);const o=n.filter(e=>e.address===t);e(null,o)})},getTransactionStatus:(t,e)=>{p.getTransaction(t,e)},getRawTransaction:(t,e)=>{p.getRawTransaction(t,e)},getPublicKey:(t,e)=>{p.decodeRawTransaction(t,(t,r)=>{if(t)return e(t);const n=r.vin[0].txinwitness[1];e(null,n)})},importAddress:(t,e)=>{p.importAddress(t,"",!1,e)},listSinceBlock:(t,e)=>{p.listSinceBlock(t,1,!0,e)},getCurrentHeight:t=>{p.getBlockchainInfo((e,r)=>{if(e)return t(e);t(null,r.blocks)})},getTransactionsFromBlockHeight:(t,e)=>{p.getBlockchainInfo((r,n)=>{if(r)return e(r);p.getBlockHash(t,(t,r)=>{if(t)return e(t);p.listSinceBlock(r,1,!0,(t,r)=>{if(t)return e(t);const o=n.blocks;console.log("height",o),r.transactions.map(t=>{t.height=o-t.confirmations+1}),e(null,r)})})})},isValidAddress:t=>{try{const e=c.decode(t).prefix.toString("hex"),r="6f"===e||"c4"===e?"testnet":"mainnet";return a.network===r}catch(t){return!1}}}},function(t,e,r){t.exports={bitcoin:r(6)}}]);